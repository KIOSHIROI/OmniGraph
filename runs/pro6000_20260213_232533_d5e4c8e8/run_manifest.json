{
  "run_id": "pro6000_20260213_232533_d5e4c8e8",
  "profile": "pro6000",
  "mode": "graph_bootstrap",
  "resolved_mode": "graph_bootstrap",
  "gpu": 0,
  "resume": false,
  "repo": "/Users/kioshiro/程序/OmniGraph",
  "command": "bash '/Users/kioshiro/程序/OmniGraph/scripts/train/run_4090_gqa_sprint.sh'",
  "profiles_file": "/Users/kioshiro/程序/OmniGraph/configs/train/infra_profiles.json",
  "profile_env": {
    "ISOLATE_GPU": "1",
    "AUTO_BATCH_BY_VRAM": "1",
    "AUTO_BATCH_RETRY_ON_OOM": "1",
    "AUTO_BATCH_MAX_RETRIES": "8",
    "AUTO_BATCH_SCALE": "1.25",
    "LLM_MODEL": "Qwen/Qwen2.5-3B-Instruct",
    "LLM_DTYPE": "bfloat16",
    "LLM_ATTN_IMPL": "sdpa",
    "VISION_MODEL": "Salesforce/blip2-flan-t5-xl",
    "NODE_ENCODER_TYPE": "hybrid",
    "NODE_ENCODER_ALPHA_INIT": "0.3",
    "NODE_ENCODER_OUT_DIM": "128",
    "GRAPH_TOKENIZER_TYPE": "perceiver",
    "STAGE2A_BOOTSTRAP_MODE": "no_stage1",
    "PERCEIVER_NUM_LATENTS": "32",
    "PERCEIVER_NUM_LAYERS": "3",
    "PERCEIVER_NUM_HEADS": "8",
    "PERCEIVER_FF_MULT": "4",
    "PERCEIVER_DROPOUT": "0.0",
    "USE_QA_TYPE_TOKEN": "1",
    "ENABLE_GVL_ADAPTER": "1",
    "ENABLE_GRAPH_AUX_HEAD": "1",
    "ENABLE_XTC": "1",
    "ENABLE_XTM": "1",
    "STAGE1_BATCH_SIZE": "16",
    "STAGE1_LR": "1e-4",
    "STAGE1_EPOCHS": "20",
    "STAGE1_MAX_STEPS": "-1",
    "STAGE1_ENABLE_EARLY_STOP": "1",
    "STAGE1_EARLY_STOP_PATIENCE": "2",
    "STAGE1_EARLY_STOP_MIN_DELTA": "0.001",
    "STAGE1_EARLY_STOP_MODE": "min",
    "STAGE1_GTM_MAX_LEN": "512",
    "STAGE1_TEXT_MAX_LEN": "512",
    "STAGE1_GTM_TEXT_SOURCE": "qa",
    "STAGE1_GTC_LOSS_WEIGHT": "1.0",
    "STAGE1_GTM_LOSS_WEIGHT": "1.2",
    "STAGE1_GTM_WARMUP_STEPS": "1000",
    "STAGE1_GTM_NEG_PER_POS": "2",
    "STAGE1_GTM_TEXT_DUP_THRESH": "0.98",
    "STAGE1_GTM_USE_HARD_NEG": "1",
    "STAGE1_GTM_LABEL_SMOOTHING": "0.0",
    "STAGE1_TEXT_MODEL_NAME": "sentence-transformers/all-mpnet-base-v2",
    "STAGE1_DATASET_PATHS": "data/train_instruct_graphmatch.json data/arxiv_pub_node_st_cot_link_mix.json",
    "TOKENIZERS_PARALLELISM": "false",
    "OMNIGRAPH_HF_CACHE": "/media/disk/02drive/13hias/.cache",
    "OMNIGRAPH_HF_ENDPOINT": "https://hf-mirror.com",
    "COVERAGE_TARGET": "0.9990",
    "LOW_VRAM_4090": "0",
    "MAX_AUTO_BATCH": "128",
    "RUN_ROUND2_ON_FAIL": "1",
    "STRICT_TARGET": "0.4250",
    "STRICT_SPRINT_TARGET": "0.4450",
    "QUERY_TARGET": "0.2650",
    "QUERY_SPRINT_TARGET": "0.2850"
  },
  "overrides": {},
  "resolved_env": {
    "AUTO_BATCH_BY_VRAM": "1",
    "AUTO_BATCH_MAX_RETRIES": "8",
    "AUTO_BATCH_RETRY_ON_OOM": "1",
    "AUTO_BATCH_SCALE": "1.25",
    "COVERAGE_TARGET": "0.9990",
    "ENABLE_GRAPH_AUX_HEAD": "1",
    "ENABLE_GVL_ADAPTER": "1",
    "ENABLE_XTC": "1",
    "ENABLE_XTM": "1",
    "GPU": "0",
    "GQA_EVAL_PAPER": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/eval/eval_val_balanced_paper.txt",
    "GQA_EVAL_R2": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/eval/eval_val_balanced_round2.txt",
    "GQA_PRED_PAPER": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/eval/pred_val_balanced_paper.jsonl",
    "GQA_PRED_R2": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/eval/pred_val_balanced_round2.jsonl",
    "GRAPH_BOOTSTRAP_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_bootstrap",
    "GRAPH_REFINE_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_refine",
    "GRAPH_REFINE_R2_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_refine_round2",
    "GRAPH_TOKENIZER_TYPE": "perceiver",
    "ISOLATE_GPU": "1",
    "LLM_ATTN_IMPL": "sdpa",
    "LLM_DTYPE": "bfloat16",
    "LLM_MODEL": "Qwen/Qwen2.5-3B-Instruct",
    "LOW_VRAM_4090": "0",
    "MAX_AUTO_BATCH": "128",
    "MULTIMODAL_TUNE_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/multimodal_tune",
    "MULTIMODAL_TUNE_R2_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/multimodal_tune_round2",
    "NODE_ENCODER_ALPHA_INIT": "0.3",
    "NODE_ENCODER_OUT_DIM": "128",
    "NODE_ENCODER_TYPE": "hybrid",
    "OMNIGRAPH_HF_CACHE": "/media/disk/02drive/13hias/.cache",
    "OMNIGRAPH_HF_ENDPOINT": "https://hf-mirror.com",
    "PERCEIVER_DROPOUT": "0.0",
    "PERCEIVER_FF_MULT": "4",
    "PERCEIVER_NUM_HEADS": "8",
    "PERCEIVER_NUM_LATENTS": "32",
    "PERCEIVER_NUM_LAYERS": "3",
    "PIPELINE_MODE": "graph_bootstrap",
    "QUERY_SPRINT_TARGET": "0.2850",
    "QUERY_TARGET": "0.2650",
    "REPO": "/Users/kioshiro/程序/OmniGraph",
    "RUN_ID": "pro6000_20260213_232533_d5e4c8e8",
    "RUN_ROUND2_ON_FAIL": "1",
    "STAGE1_BATCH_SIZE": "16",
    "STAGE1_DATASET_PATHS": "data/train_instruct_graphmatch.json data/arxiv_pub_node_st_cot_link_mix.json",
    "STAGE1_EARLY_STOP_MIN_DELTA": "0.001",
    "STAGE1_EARLY_STOP_MODE": "min",
    "STAGE1_EARLY_STOP_PATIENCE": "2",
    "STAGE1_ENABLE_EARLY_STOP": "1",
    "STAGE1_EPOCHS": "20",
    "STAGE1_EXPORT_PATH": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_qformer_stage1.pt",
    "STAGE1_GTC_LOSS_WEIGHT": "1.0",
    "STAGE1_GTM_LABEL_SMOOTHING": "0.0",
    "STAGE1_GTM_LOSS_WEIGHT": "1.2",
    "STAGE1_GTM_MAX_LEN": "512",
    "STAGE1_GTM_NEG_PER_POS": "2",
    "STAGE1_GTM_TEXT_DUP_THRESH": "0.98",
    "STAGE1_GTM_TEXT_SOURCE": "qa",
    "STAGE1_GTM_USE_HARD_NEG": "1",
    "STAGE1_GTM_WARMUP_STEPS": "1000",
    "STAGE1_LR": "1e-4",
    "STAGE1_MAX_STEPS": "-1",
    "STAGE1_TEXT_MAX_LEN": "512",
    "STAGE1_TEXT_MODEL_NAME": "sentence-transformers/all-mpnet-base-v2",
    "STAGE2A_BOOTSTRAP_MODE": "no_stage1",
    "STAGE2A_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_bootstrap",
    "STAGE2B_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_refine",
    "STAGE2B_R2_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/graph_refine_round2",
    "STAGE3_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/multimodal_tune",
    "STAGE3_R2_DIR": "/Users/kioshiro/程序/OmniGraph/runs/pro6000_20260213_232533_d5e4c8e8/checkpoints/multimodal_tune_round2",
    "STRICT_SPRINT_TARGET": "0.4450",
    "STRICT_TARGET": "0.4250",
    "TOKENIZERS_PARALLELISM": "false",
    "USE_QA_TYPE_TOKEN": "1",
    "VISION_MODEL": "Salesforce/blip2-flan-t5-xl"
  },
  "git": {
    "branch": "main",
    "commit": "29838a3abd9d607a6020f86daac5380fc3f096a5",
    "short_commit": "29838a3",
    "dirty": true,
    "dirty_file_count": 34,
    "dirty_file_preview": [
      "M configs/train/infra_profiles.json",
      " M omnigraph/data/vg_scene_graph_dataset.py",
      " M omnigraph/train/train_projector.py",
      " M omnigraph/train/train_stage2B.py",
      " M omnigraph/train/train_stage3.py",
      " M scripts/eval/infer_gqa.py",
      " M scripts/eval/infer_vg_region_caption.py",
      " M scripts/eval/run_infer_gqa.sh",
      " M scripts/train/README_INFRA.md",
      " M scripts/train/infra_launcher.py",
      " M scripts/train/run_4090_gqa_sprint.sh",
      " M stage2.sh",
      " M train_stage2A.sh",
      " M train_stage2B.sh",
      " M train_stage3.sh",
      "?? omnigraph/data/graph_canonical.py",
      "?? omnigraph/model/v2g/",
      "?? omnigraph/train/alignment_step.py",
      "?? omnigraph/train/graph_tokenizer_provenance.py",
      "?? omnigraph/train/pipeline_data.py"
    ]
  },
  "system": {
    "python": "3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 12:55:12) [Clang 14.0.6 ]",
    "platform": "macOS-15.6.1-arm64-arm-64bit",
    "hostname": "kioshirodeMacBook-Air.local"
  },
  "created_at": "2026-02-13T23:25:33"
}